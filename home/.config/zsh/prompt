function preexec() {
  timer=$(($(date +%s%0N)/1000000))
}

function precmd() {
  if [ $timer ]; then
    now=$(($(date +%s%0N)/1000000))
    elapsed=$(($now-$timer))

    export RPROMPT="%F{cyan}${elapsed}ms %f"
    unset timer
  fi
}

PROMPT="%(!.%F{magenta}.%F{12})%n@%m%f %F{green}%~%f"$'\n'"%(?..%F{red}%? %f)‚ù± "